# Short guide on using this tool

This tool is used to generate data in JSON format from cumulative data generated by CodeCarbon (output file in CodeCarbon CSV format).
It works by generating a pre-filled form with data from the cumulative CSV generated by CodeCarbon or completly blank with `gen_form.sh`.
- example1 : ./gen_form.sh -a Ref_CodeCarbon.csv CodeCarbonCSV.conf > report1.txt
- example2 : ./gen_form.sh -a Ref_CodeCarbon.csv CodeCarbonCSV.conf emissions.csv 2 > report-codecarbon-prefill.txt

Then, to obtain the Boamp format (current version), you need to transform the forms into JSON using the `form2json.sh` tool.
- exemple: ./form2json.sh -a Ref_CodeCarbon.csv report1.txt > json_example.json

## Description of Ref-CodeCarbon.csv and usage

In the `reference.csv` file, you will find the Boamps format with, in addition, in the `cmd` column, the tools to pre-fill from an input CSV.
There are several options for filling the `cmd` column:
- Just a string (without # or :) indicates the name of the column in the input CSV to put in the form field.
- String preceded by a # (without # or : in the rest of the string): puts in the form field the value of the string without the # (fixed value).
- String containing : (without # in the string): represents a list separated by :, each element (CSV column) will be put in the form iteration according to its position in the described list.
- If no column matches an entry of type String, float, etc. (outside object and end), put: no (to fill nothing in the form).
- You can also hybridize # and : to make a list where in the first iteration, you put a fixed value, but in the second, you put the element (CSV column).

## Example commands

WARNING: this is a BASH tool to be run in a Linux bash command line :)

`./gen_form.sh -a Ref_CodeCarbon.csv CodeCarbonCSV.conf > report1.txt`
`./gen_form.sh -a Ref_CodeCarbon.csv CodeCarbonCSV.conf emissions.csv 2 > report-codecarbon-prefill.txt`

`./form2json.sh -a Ref_CodeCarbon.csv report1.txt > json_example.json`


## Example Files
Here is a list and information about the sample or example files provided :
- form_example.txt: Example of a form generated by `gen_form.sh` with `Ref_CodeCarbon.csv` , `CodeCarbonCSV.conf` and the second line of sample_emissions.csv.
- json_example.json: Example of a JSON file generated by `form2json.sh` from the `form_example.txt`. (Beware it contain only field present in the codecarbon csv mandatory fields must be added)
- example-carbon.py: Example Python script that uses CodeCarbon Tracker
- sample_emissions.csv: Sample CSV file containing emissions data generated with CodeCarbon that can be used as input for the `gen_form.sh` script.

## Troubleshooting:
- if you have this error: "/bin/bash^M: bad interpreter: No such file or directory" -> use this command: `sed -i -e 's/\r$//' <script_name>`